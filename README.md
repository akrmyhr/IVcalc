IV計算（小児/新生児）— Peds IV Calc + Osmolarity + Rules

教育・研究補助用のプロトタイプです。
臨床適用時は必ず検算し、各施設のプロトコルと責任者の確認を経た上で使うこと。

免責（重要）

本ツールは医療機器ではない。結果の正確性・完全性は保証できない。
誤入力・近似・未収載製剤により誤差やミスが生じうる。必ず二系統以上で検算し、患者安全を最優先とする。
施設・年齢・病態により許容閾値が異なる（例：末梢の浸透圧、K濃度/速度）。本ツールの既定値は保守的目安にすぎない。

参考式・組成は下記「根拠と出典」およびアプリ内「参考・出典」セクションを参照。

何ができるか

配合の**電解質量（mEq/日・mEq/kg/日）とリン（mmol/日）**の集計
GIR（mg/kg/min）、WQ（mL/kg/day）、栄養（kcal/日・脂肪 g/kg/日）
理論浸透圧（任意でアミノ酸寄与を加算）
配合禁忌・注意の検出：Ca×P、Ca×HCO₃⁻（禁忌）、Mg×P（注意）、脂肪乳剤混注不可

安全域アラート：
末梢ルート：浸透圧 > 900 mOsm/L で警告（施設により閾値は調整が必要）
K濃度 > 40 mEq/L、K速度 > 20 mEq/h（ライン・ボーラスを評価）
ボーラス投与入力（容量・回数/日・投与時間・ルート）と、点滴と合算評価
iPhoneでも操作しやすいモバイルUI（行カード化、目立つ「計算」ボタン）

使い方（概要）

体重（kg）を入れる。
「ライン追加」→ ルート、成分、容量（mL）、流量（mL/h）を入れる。
ボーラスがあれば下の「ボーラス投与」に製品、容量、回数/日、投与時間（分・任意）、ルート。
計算を押す。結果に概要・電解質/日・ライン別濃度/浸透圧・栄養・警告が出る。
必ず検算する（下記「検算のすすめ」）。

閾値（既定の警告条件）

末梢の理論浸透圧：> 900 mOsm/L で警告
K濃度：> 40 mEq/L
K速度：> 20 mEq/h
GIR：一般 > 5 mg/kg/min、新生児は目標域 8–12 を目安
脂肪：> 0.10 g/kg/h、> 2 g/kg/day で注意喚起
※ 閾値は施設方針に合わせて調整が必要。本実装は保守的目安の初期値にすぎない。

計算式

GIR (mg/kg/min) = 総ブドウ糖[g/日] × 1000 / (体重[kg] × 1440)
WQ (mL/kg/day) = 総流量[mL/h] × 24 / 体重[kg]
理論浸透圧 (mOsm/L)
= Σ(各イオンの mmol/L) + P[mmol/L] + Glucose[mmol/L] + （任意）AA寄与
ただし mmol = mEq / |z|、|z|は価数（Na,K,Cl,HCO₃⁻,乳酸,酢酸=1、Ca,Mg=2、クエン酸=3, 硫酸=2）
Glucose[mmol/L] = (Glucose[g/L] / 180.156) × 1000
AA寄与は経験値として 9 × AA[g/L] を採用（施設で係数調整可）

kcal/日 = 4×(ブドウ糖g/日 + アミノ酸g/日) + 9×(脂肪g/日)
※ 脂肪は添文のkcal/mLがあればそれを優先

収載製剤（このプロトタイプに同梱）
基本輸液・維持液・糖液（1Lあたり）
製剤	Na	K	Ca	Mg	Cl	乳酸	酢酸	P (mmol/L)	ブドウ糖 (g/L)
生理食塩液 0.9%	154	–	–	–	154	–	–	–	–
乳酸リンゲル	130	4	3	–	109	28	–	–	–
酢酸リンゲル（ヴィーンF相当）	130	4	3	–	109	–	28	–	–
酢酸リンゲル＋Glu5%（ヴィーンD相当）	130	4	3	–	109	–	28	–	50
ソリタT1	90	–	–	–	70	20	–	–	26
ソリタT2	84	20	–	–	66	20	–	10	32
ソリタT3	35	20	–	–	35	20	–	–	43
ソリタT3G	35	20	–	–	35	20	–	–	75
G5 / G10 / G20 / G50	–	–	–	–	–	–	–	–	50 / 100 / 200 / 500
注射用水（溶媒）	–	–	–	–	–	–	–	–	–
添加薬（濃縮：1mLあたり）
製剤	Na	K	Ca	Mg	Cl	HCO₃⁻	P
KCl 1 mEq/mL（混注）	–	1.00 mEq/mL	–	–	1.00 mEq/mL	–	–
リン酸Na 10mmol/20mL	0.75 mEq/mL	–	–	–	–	–	0.50 mmol/mL
リン酸K 10mmol/20mL	–	1.00 mEq/mL	–	–	–	–	0.50 mmol/mL
重炭酸Na 8.4%	1.00 mEq/mL	–	–	–	–	1.00 mEq/mL	–
Caグルコン酸 8.5%	–	–	0.39 mEq/mL	–	–	–	–
MgSO₄ 1 mEq/mL	–	–	–	1.00 mEq/mL	–	–	–
栄養（アミノ酸・脂肪乳剤）
製剤	アミノ酸 (g/L)	脂肪 (g/L)	kcal/mL	備考
アミノ酸10%（汎用）	100	–	約0.4	電解質無添加想定
イントラリポス10%	–	100	1.1	添文準拠
イントラリポス20%	–	200	2.0	添文準拠

酢酸リンゲルのNaは製品により130–131 mEq/Lの揺れがあるため、DBでは130に正規化している。

検算のすすめ（最少手順）

ライン内濃度
各成分の総量 = Σ(成分の「濃度/ mL」× 容量mL)
ライン濃度（mEq/L 等）= 総量 / 総容量(L)
K安全域
濃度（mEq/L）= ラインK濃度。>40なら要再設計（末梢）。
速度（mEq/h）= ラインK濃度（mEq/mL）× 流量（mL/h）。>20なら要修正。

GIR
GIR = 総ブドウ糖[g/日]×1000/(kg×1440)。一般>5は高め、新生児は8–12目安。

浸透圧
mmol/L換算して総和＋P＋Glucose（＋任意AA寄与）。末梢は**≤900**目安。

配合禁忌
Ca×P、Ca×HCO₃⁻（禁忌）、Mg×P（注意）、脂肪混注不可をチェック。

クロスチェック
別ツール・表計算・電卓の二重系で再計算。

「参考・出典」表と**濃度の出所（PDF/添文）**を見比べて矛盾がないか確認。

データの根拠と出典

水・電解質製剤 組成表(yueki.com）
https://www.yueki.com/files/composition_search/water_electrolyte.pdf

栄養（糖・アミノ酸・脂肪乳剤）組成表（yueki.com）
https://www.yueki.com/files/composition_search/nutrition.pdf

添加薬（KCl、リン酸Na/K、重炭酸Na、Caグルコン酸、MgSO₄）は各製剤の添付文書の標準値に準拠。
末梢の許容浸透圧（≤900 mOsm/L）はPPNの一般推奨に基づく。小児・新生児では施設差があるため、施設閾値を優先。


開発メモ

単一ファイル：index.html
UI/スタイル：HTML/CSS
計算・DB：<script type="py"> 内（PyScript/Pyodide）

主要関数：
build_db()：製剤DB（濃度・糖・P）
compute()：集計・警告
osmolarity()：理論浸透圧
製剤の追加方法：build_db() に Component(...) を追記（単位は mEq/mL, mmol/mL, g/mL を厳守）。
閾値の変更：PERIPHERAL_OSM_LIMIT, KCL_MAX_CONC, KCL_MAX_RATE, ほかの定数を修正。

既知の制限

PyScript/pyodideを初回ロードするため、初回表示が重い。
一部モバイル環境でスクロール中の再計算にラグが出る場合がある。
製剤名のバリエーション（ブランド名違い）は収載を簡略化。施設採用名に合わせてDB更新が必要。
アミノ酸の浸透圧寄与係数（初期値=9）は近似。施設の式に合わせて調整すべき。

コントリビュート

Issue：誤り報告・要望
Pull Request：
小さな差分（1機能/1修正）で送る
変更点、根拠（PDF/添文ページ）を必ず記載

計算影響がある場合は検算例を添付

ライセンスと責任

ライセンスはリポジトリの LICENSE を参照。
本ツールの利用によるいかなる結果に対しても、作者・貢献者は責任を負わない。臨床判断と最終責任は利用者にある。

連絡

バグ・提案・追加したい製剤があれば、Issueへ。

臨床現場のプロトコル差異に合わせた閾値プリセットの提案も歓迎する。
